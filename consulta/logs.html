<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Logs</title>
  <link rel="stylesheet" href="../assets/css/style.css" />

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
</head>
<body class="dp-center">
  <div class="card" style="width:760px">
    <div class="toolbar">
      <h2 class="title" style="margin:0">Logs</h2>
      <div><button class="btn" onclick="location.href='../menu.html'">Voltar</button></div>
    </div>

    <table class="table" id="tbl">
      <thead><tr><th>Data</th><th>Usuário</th><th>Ação</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyB5IT8QbzljkYD3DW1VxaHNRhokANIpKj4",
      authDomain: "mu-epoch.firebaseapp.com",
      projectId: "mu-epoch",
      storageBucket: "mu-epoch.firebasestorage.app",
      messagingSenderId: "995547087811",
      appId: "1:995547087811:web:9a4581071b931f9364f376",
      measurementId: "G-NM65WWHE91"
    };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    window.db = firebase.firestore();
  </script>
  <script src="../js/script.js?v=2025-11-03-zip"></script>
  <script>
    requireAdminOrRedirect();
    (async ()=>{
      await ensureFirebase();
      const tbody=document.querySelector('#tbl tbody');
      const snap=await db.collection("logs_actions").orderBy("data","desc").limit(200).get();
      tbody.innerHTML='';
      snap.forEach(d=>{
        const x=d.data();
        const tr=document.createElement('tr');
        tr.innerHTML=`<td>${new Date(x.data).toLocaleString()}</td><td>${x.usuario||''}</td><td>${x.acao||''}</td>`;
        tbody.appendChild(tr);
      });
    })();
  </script>
</body>
</html>
